# 介接契約與版本管理

## 這一章在解什麼
跨機關/跨系統介接最常見的事故：
- 對方改欄位沒通知
- 憑證到期/白名單更換沒協調
- 失敗後不知道怎麼補送/對帳

解法是把「介接」當成一份可治理的契約（Data/API Contract）。

## 會議話術
「介接不是『有通就好』，我們需要一份**介接契約**：欄位/版本/變更通知/錯誤處理/補送對帳/憑證輪替都要寫清楚，才能把維運風險降下來。」

## 介接契約模板（可複製）
- 介接名稱：
- 雙方窗口（含緊急聯絡）：
- 介接方式：API / 檔案 / DB / 訊息
- 更新頻率：即時/每小時/每日/每週
- 認證授權：憑證/VPN/白名單/金鑰；輪替週期：
- Schema：欄位清單、型別、必填、代碼表；版本：v1/v2
- 相容策略：向後相容？棄用流程？提前通知天數？
- 錯誤碼與重試：可重試/不可重試；重試次數與間隔
- 冪等性：重送同一筆資料是否安全？Key 是什麼？
- 速率限制：每分鐘/每秒上限；超限行為
- 監控告警：失敗如何告警？誰接？多久回應？
- 對帳/補送：對帳頻率、差異處理、補送流程

## 驗收建議
- 模擬對方斷線/回傳錯誤碼 → 系統能告警、能重試、能人工補送
- 模擬欄位新增/棄用 → 系統有版本策略或相容處理

## 常見坑
- 沒有測試環境/模擬器 → 上線才發現格式不合
- 沒有變更通知機制 → 對方一改你就掛
