# 權限與角色矩陣

## 這一章在解什麼
政府專案最常見的失敗之一：功能都做完了，但因為**誰能看、誰能改、誰能決行、誰能調閱**沒定義，最後驗收/稽核卡死。

## 你要先決定的三件事
- **授權模型**：角色為主（RBAC）？屬性/條件為主（ABAC）？是否需要資料列級（row-level）與欄位級（field-level）控制？
- **角色範圍**：內部人員（承辦/覆核/主管/稽核調閱/系統管理者）＋ 外部（民眾/承商/其他機關）
- **權限治理**：權限申請/核可/到期收回、代理/代辦、特權帳號規範

## 會議回應示例（照念）
「我們先把**角色與權限矩陣**定義清楚：每個角色在每個狀態能看什麼、能改什麼、能決行什麼，並把『調閱』也納入稽核。這會直接影響資料保護與驗收。」

## 角色/權限矩陣模板（可複製）
> 建議做法：先列出「功能」再列「資料範圍」，最後再加「狀態限制」。

### 1) 角色清單
- 內部：承辦、覆核、主管/決行、會辦、稽核調閱、系統管理者
- 外部：民眾/企業申請人、承商、其他機關（查詢/回傳）

### 2) 功能權限矩陣（範例表）
| 功能/操作 | 承辦 | 覆核 | 主管/決行 | 稽核調閱 | 系統管理者 | 外部使用者 |
|---|---:|---:|---:|---:|---:|---:|
| 新增案件/資料 | 允許 | - | - | - | - | 依情境 |
| 編輯案件/資料 | 允許（受狀態限制） | 允許（僅意見） | 允許（決行欄位） | 不允許 | 允許 | 依情境 |
| 送審/退回/核定 | 送審 | 退回/建議 | 核定/退回 | 不允許 | 允許（限管控） | - |
| 上傳/下載附件 | 允許 | 允許 | 允許 | 允許（留痕） | 允許 | 允許（僅自身） |
| 匯出證據包/報表 | 允許（自身） | 允許（範圍） | 允許（全域） | 允許（全域） | 允許 | - |

### 3) 資料範圍（資料列級）
| 角色 | 可看到的資料範圍 | 備註 |
|---|---|---|
| 承辦 | 自己承辦/所屬單位 | 是否可跨單位支援？ |
| 覆核 | 所屬單位全部 | 是否可跨案件類別？ |
| 主管/決行 | 轄下全部 | 是否含歷史封存？ |
| 稽核調閱 | 依法定職權 | 調閱也需留痕 |
| 外部使用者 | 僅自己案件/資料 | 需身份驗證 |

### 4) 狀態限制（進件審核常見）
| 狀態 | 允許編輯欄位 | 允許附件 | 允許決行 |
|---|---|---|---|
| 草稿 | 全部 | 允許 | 不允許 |
| 審核中 | 部分（補正欄位） | 允許（受限） | 覆核/決行 |
| 核定/結案 | 不允許（僅更正流程） | 允許（調閱） | 不允許 |

## 必問清單（把需求談完整）
- 誰可以「跨單位」查/改？誰可以「代辦」？代辦是否要留痕？
- 敏感欄位（個資、金額、裁罰結果）是否需要欄位級遮罩？
- 稽核調閱是否需要「申請/核可」？調閱是否要留痕？
- 系統管理者是否可以改業務資料？若不行，改配置/權限需有什麼流程？

## 驗收建議
- 用「角色測試清單」驗收：每個角色至少 10 個操作案例（含例外/越權）
- 抽查 3 類資料範圍：同案、同單位不同人、跨單位

## 常見坑
- 只做功能權限，沒做資料範圍（row-level）→ 很快就被要求補
- 把「系統管理者」當超級使用者 → 會被要求做權限分權與稽核
